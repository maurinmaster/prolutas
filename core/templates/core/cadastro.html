{% extends 'core/base_auth.html' %}

{% block title %}Cadastre sua Academia - Pro-Lutas Gestão{% endblock %}

{% block container_class %} large{% endblock %}

{% block extra_css %}
<style>
    .form-section {
        background-color: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
    }
    .section-title {
        color: #343a40;
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
    .section-title::before {
        content: "";
        width: 4px;
        height: 20px;
        background-color: #007bff;
        border-radius: 2px;
    }
    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin-bottom: 1rem;
    }
    .form-field {
        margin-bottom: 1rem;
    }
    .form-field label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
        color: #495057;
    }
    .form-field input, .form-field select, .form-field textarea {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid #ced4da;
        border-radius: 5px;
        font-size: 0.95rem;
        transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
    }
    .form-field input:focus, .form-field select:focus, .form-field textarea:focus {
        outline: none;
        border-color: #007bff;
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
    }
    .help-text {
        font-size: 0.8rem;
        color: #6c757d;
        margin-top: 0.25rem;
    }
    .btn-primary {
        padding: 0.9rem 2rem;
        font-size: 1rem;
        font-weight: 600;
        border-radius: 6px;
    }
    .progress-indicator {
        display: flex;
        justify-content: center;
        margin-bottom: 2rem;
    }
    .progress-step {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: #e9ecef;
        color: #6c757d;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        margin: 0 1rem;
        position: relative;
    }
    .progress-step.active {
        background-color: #007bff;
        color: white;
    }
    .progress-step.completed {
        background-color: #28a745;
        color: white;
    }
    .progress-step:not(:last-child)::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 100%;
        width: 2rem;
        height: 2px;
        background-color: #e9ecef;
        transform: translateY(-50%);
    }
    .progress-step.completed:not(:last-child)::after {
        background-color: #28a745;
    }
    @media (max-width: 768px) {
        .form-row {
            grid-template-columns: 1fr;
        }
        .progress-indicator {
            margin-bottom: 1rem;
        }
        .progress-step {
            width: 30px;
            height: 30px;
            font-size: 0.8rem;
            margin: 0 0.5rem;
        }
        .progress-step:not(:last-child)::after {
            width: 1rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="text-center mb-4">
    <h3>Cadastre sua Academia</h3>
    <p class="text-muted">Preencha os dados abaixo para começar a usar o sistema</p>
</div>

<div class="progress-indicator">
    <div class="progress-step active">1</div>
    <div class="progress-step">2</div>
</div>

<form method="post" id="cadastro-form">
    {% csrf_token %}
    
    <div class="form-section">
        <h4 class="section-title">
            <i class="bi bi-person-circle"></i>
            Dados do Proprietário
        </h4>
        
        <div class="form-row">
            <div class="form-field">
                <label for="id_username">{{ form_user.username.label }}</label>
                {{ form_user.username }}
                {% if form_user.username.help_text %}
                    <div class="help-text">{{ form_user.username.help_text }}</div>
                {% endif %}
                {% if form_user.username.errors %}
                    <div class="text-danger small">{{ form_user.username.errors.0 }}</div>
                {% endif %}
            </div>
            <div class="form-field">
                <label for="id_email">{{ form_user.email.label }}</label>
                {{ form_user.email }}
                {% if form_user.email.errors %}
                    <div class="text-danger small">{{ form_user.email.errors.0 }}</div>
                {% endif %}
            </div>
        </div>
        
        <div class="form-row">
            <div class="form-field">
                <label for="id_first_name">{{ form_user.first_name.label }}</label>
                {{ form_user.first_name }}
                {% if form_user.first_name.errors %}
                    <div class="text-danger small">{{ form_user.first_name.errors.0 }}</div>
                {% endif %}
            </div>
            <div class="form-field">
                <label for="id_last_name">{{ form_user.last_name.label }}</label>
                {{ form_user.last_name }}
                {% if form_user.last_name.errors %}
                    <div class="text-danger small">{{ form_user.last_name.errors.0 }}</div>
                {% endif %}
            </div>
        </div>
        
        <div class="form-row">
            <div class="form-field">
                <label for="id_password1">{{ form_user.password1.label }}</label>
                {{ form_user.password1 }}
                {% if form_user.password1.help_text %}
                    <div class="help-text">{{ form_user.password1.help_text }}</div>
                {% endif %}
                {% if form_user.password1.errors %}
                    <div class="text-danger small">{{ form_user.password1.errors.0 }}</div>
                {% endif %}
            </div>
            <div class="form-field">
                <label for="id_password2">{{ form_user.password2.label }}</label>
                {{ form_user.password2 }}
                {% if form_user.password2.help_text %}
                    <div class="help-text">{{ form_user.password2.help_text }}</div>
                {% endif %}
                {% if form_user.password2.errors %}
                    <div class="text-danger small">{{ form_user.password2.errors.0 }}</div>
                {% endif %}
            </div>
        </div>
    </div>
    
    <div class="form-section">
        <h4 class="section-title">
            <i class="bi bi-building"></i>
            Dados da Academia
        </h4>
        
        <div class="form-row">
            <div class="form-field">
                <label for="id_nome">{{ form_academia.nome.label }}</label>
                {{ form_academia.nome }}
                {% if form_academia.nome.errors %}
                    <div class="text-danger small">{{ form_academia.nome.errors.0 }}</div>
                {% endif %}
            </div>
            <div class="form-field">
                <label for="id_telefone">{{ form_academia.telefone.label }}</label>
                {{ form_academia.telefone }}
                {% if form_academia.telefone.errors %}
                    <div class="text-danger small">{{ form_academia.telefone.errors.0 }}</div>
                {% endif %}
            </div>
        </div>
        
        <div class="form-field">
            <label for="id_endereco">{{ form_academia.endereco.label }}</label>
            {{ form_academia.endereco }}
            {% if form_academia.endereco.errors %}
                <div class="text-danger small">{{ form_academia.endereco.errors.0 }}</div>
            {% endif %}
        </div>
        
        <!-- Adicionar outros campos da academia aqui conforme necessário -->
        {% for field in form_academia %}
            {% if field.name not in "nome,telefone,endereco" %}
                <div class="form-field">
                    <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                    {{ field }}
                    {% if field.help_text %}
                        <div class="help-text">{{ field.help_text }}</div>
                    {% endif %}
                    {% if field.errors %}
                        <div class="text-danger small">{{ field.errors.0 }}</div>
                    {% endif %}
                </div>
            {% endif %}
        {% endfor %}
    </div>
    
    <div class="d-grid mb-3">
        <button type="submit" class="btn btn-primary">
            <i class="bi bi-check-circle me-2"></i>
            Finalizar Cadastro
        </button>
    </div>
</form>

<div class="text-center">
    <p class="text-muted mb-0">
        Já tem uma conta? 
        <a href="{% url 'login' %}" class="text-decoration-none fw-semibold">Faça login aqui!</a>
    </p>
</div>

{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Simular progresso do formulário
    const form = document.getElementById('cadastro-form');
    const steps = document.querySelectorAll('.progress-step');
    
    // Marcar primeiro passo como ativo
    steps[0].classList.add('active');
    
    // Adicionar validação visual aos campos
    const inputs = form.querySelectorAll('input, select, textarea');
    inputs.forEach(input => {
        input.addEventListener('blur', function() {
            if (this.value.trim() !== '') {
                this.style.borderColor = '#28a745';
            } else {
                this.style.borderColor = '#ced4da';
            }
        });
    });
    
    // Atualizar progresso baseado no preenchimento
    function updateProgress() {
        const userFields = form.querySelectorAll('[name^="username"], [name^="email"], [name^="first_name"], [name^="last_name"], [name^="password"]');
        const academiaFields = form.querySelectorAll('[name^="nome"], [name^="telefone"], [name^="endereco"]');
        
        let userFilled = 0;
        userFields.forEach(field => {
            if (field.value.trim() !== '') userFilled++;
        });
        
        let academiaFilled = 0;
        academiaFields.forEach(field => {
            if (field.value.trim() !== '') academiaFilled++;
        });
        
        // Atualizar indicadores visuais
        if (userFilled > userFields.length / 2) {
            steps[0].classList.add('completed');
            steps[0].classList.remove('active');
            steps[1].classList.add('active');
        }
        
        if (academiaFilled > academiaFields.length / 2) {
            steps[1].classList.add('completed');
        }
    }
    
    inputs.forEach(input => {
        input.addEventListener('input', updateProgress);
    });
});
</script>
{% endblock %}